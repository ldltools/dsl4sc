_modelgen_ reads a DFA definition generated by [rules2dfa](../rules2dfa/README.md),
and transforms it to another, more detailed, form.

## usage

```
$ modelgen <dfa_file>
```

## input to _modelgen_

DFAs for modelgen can be generated most conveniently by running:
`$ rules2scxml model.dsl --until dfa`.

Each DFA definition includes the following blocks:

- variables  
  These variables originate from the event names and the property variables that appear in the DSL4SC model.
- states (w/o. formulas)  
  generated by [mona](http://www.brics.dk/mona/)
- transitions (w. formulas)  
  generated by [mona](http://www.brics.dk/mona/)
- rules  
  these directly correspond with the rules in the DSL4SC model.
- scripts (optional)

## output of _modelgen_

_modelgen_ generates a new DFA.

- its state-machine structure remains identical with the input DFA, but
- its states, transitions, and rules are extended with extra information
  for _executable model_ generation.
- the variables and the scripts remain intact.

## model generation (in detail)

The states, transitions, and rules of in the input definition are updated as follows.

1. [states]  
   restore _possible worlds_ (formulas) to the states  
   The formula to be generated for each state is
   a disjunction of the formulas carried by the transitions to the state.

   note: **propositional simplifier** is employed.

   (`Modelgen.restore_possible_worlds`)

1. [transitions]  
   split transitions when they can be triggered by more than one events.  

   (`Modelgen.split_transitions`)

1. [rules]  
   generate rule-to-transitions mappings.

   (`Modelgen.chart_rules`)

   - generate _rule-transition_ pairs _{(r, t), ...}_
     which indicates _r_ can be associated with _t_.  

     (`Modelgen.find_applicable_rules`)  

     note: **propositional prover** is intensively exploited.

   - for each rule _r_, aggregate transitions _t1, t2, .._,
     where _(r, ti)_ is included in the pairs,
     and generate a single pair (_r, {t1, t2, ..}_).  

     (`Modelgen.aggregate_transitions`)  
